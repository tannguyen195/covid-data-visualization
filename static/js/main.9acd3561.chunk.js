(this["webpackJsonpcovid-data-visualization"]=this["webpackJsonpcovid-data-visualization"]||[]).push([[0],{41:function(e,t,n){},42:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var c=n(7),r=n.n(c),a=n(20),i=n.n(a),o=(n(41),n(10)),s=(n(42),n(13)),l=n(53),u=n(52),d=n(49),j=n(51),b=n(11),f=n(50),h=n(0),O=n(27),m=n.n(O)()((function(e,t){return{data:null,setData:function(t){e((function(){return{data:t}}))},error:null,setError:function(t){e((function(){return{error:t}}))},loading:!0,setLoading:function(t){e((function(){return{loading:t}}))},cameraPosition:new h.Vector3(1.0959887504577637,.005898133385926485,.19488362967967987),activeMesh:null,setCameraPosition:function(t){e((function(){return{activeMesh:t.activeMesh}}))},isResetCamera:!1,resetCamera:function(t){e((function(){return{isResetCamera:t}}))}}})),p=n(8);var v=function(e){var t=e.text,n=e.hovered,r=e.position,a=e.animate,i=e.color,l=e.name,u=Object(c.useRef)(),d=m((function(e){return e.activeMesh}));return Object(s.d)((function(){a&&(u.current.position.y=h.MathUtils.lerp(u.current.position.y,d===l||n?.05:0,.08))})),Object(p.jsx)(f.a,Object(o.a)(Object(o.a)({ref:u,position:r,depthTest:!1,"material-toneMapped":!1,color:i},{fontSize:.01,font:"/covid-data-visualization/Roboto-MediumItalic.ttf"}),{},{children:a?(d===l||n)&&t:t}))},x=n(30),g=n.n(x);function C(e){return e.toLocaleString()}var y=function(e){var t=e.name,n=e.geometry,r=e.position,a=e.color,i=e.province,o=Object(c.useRef)(),l=Object(c.useState)(!1),u=Object(b.a)(l,2),d=u[0],j=u[1],f=m((function(e){return e.setCameraPosition})),O=m((function(e){return e.activeMesh}));return Object(c.useEffect)((function(){if(d)return document.body.style.cursor="pointer",function(){return document.body.style.cursor="auto"}}),[d]),Object(s.d)((function(){o.current.position.y=h.MathUtils.lerp(o.current.position.y,d||O===t?.01:0,.05)})),Object(p.jsxs)("group",{name:t,ref:o,onClick:function(){f({activeMesh:t})},onPointerOver:function(e){return j(!0)},onPointerOut:function(){return j(!1)},position:r,children:[Object(p.jsx)(v,{name:t,animate:!1,position:[0,.01,.01],text:i.name,hovered:d}),Object(p.jsx)(v,{name:t,color:"#111",animate:!0,position:[0,.01,-.05],text:"S\u1ed1 ca nhi\u1ec5m: ".concat(C(i.cases),"\n           T\u1eed vong: ").concat(C(i.death),"\n           H\xf4m nay: +").concat(C(i.casesToday)),hovered:d}),Object(p.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:n,material:new h.MeshStandardMaterial({color:a})})]})};function M(e){var t=Object(c.useRef)(),n=Object(j.a)("/covid-data-visualization/map.gltf").scene,r=m((function(e){return e.data})),a=function(){var e=[];return n.traverse((function(t){if(t.isMesh){var n=function(e,t){return t.find((function(t){return t.normalizedName===e}))}(t.name,r.locations),c=function(e){return g.a.scale(["#f00","#0f0"]).colors(63)[e.id]}(n);e.push(Object(p.jsx)(y,{position:t.position,name:t.name,geometry:t.geometry,color:c,province:n},t.name))}})),e};return Object(p.jsx)("group",Object(o.a)(Object(o.a)({ref:t},e),{},{dispose:null,position:[-10,0,5],children:r&&Object(p.jsx)(a,{})}))}j.a.preload("/covid-data-visualization/map.gltf");var S=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("mesh",{receiveShadow:!0,position:[0,-.2,0],"rotation-x":-Math.PI/2,children:[Object(p.jsx)("planeBufferGeometry",{args:[200,200]}),Object(p.jsx)("shadowMaterial",{transparent:!0,opacity:.5})]}),Object(p.jsx)(M,{scale:10})]})},w=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("ambientLight",{intensity:.5}),Object(p.jsx)("spotLight",{penumbra:1,angle:.35,castShadow:!0,position:[40,200,0],intensity:.5,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-visible":!0,"shadow-darkness":.2})]})},z=function(){var e=m((function(e){return e.activeMesh})),t=m((function(e){return e.isResetCamera})),n=m((function(e){return e.resetCamera})),r=Object(c.useState)(""),a=Object(b.a)(r,2),i=a[0],o=a[1];return Object(s.d)((function(c){var r=c.camera,a=c.scene,s=new h.Vector3;if(i!==e&&e){var l,u,d;null===(l=a.getObjectByName(e))||void 0===l||l.getWorldPosition(s);var j={x:s.x,y:s.y+3,z:s.z+7};r.position.lerp(j,.05),null===(u=a.orbitControls)||void 0===u||u.target.lerp(s,.05),null===(d=a.orbitControls)||void 0===d||d.update(),r.position.clone().sub(j).length()<1&&o(e)}if(t){var b,f,O={x:0,y:90,z:10};r.position.lerp(O,.05),null===(b=a.orbitControls)||void 0===b||b.target.lerp({x:0,y:0,z:0},.05),null===(f=a.orbitControls)||void 0===f||f.update(),r.position.clone().sub(O).length()<1&&n(!1)}})),null};var N=function(){var e=m((function(e){return e.data})),t=m((function(e){return e.setCameraPosition})),n=m((function(e){return e.resetCamera}));return Object(p.jsxs)("div",{className:"statistic-panel",children:[Object(p.jsx)("div",{className:"control",children:Object(p.jsx)("button",{onClick:function(){return n(!0)},children:"Reset Camera"})}),e&&Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{className:"tbl-header",children:Object(p.jsx)("table",{cellPadding:"0",cellSpacing:"0",border:"0",children:Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{className:"tr-header",children:[Object(p.jsx)("th",{children:"T\u1ec9nh"}),Object(p.jsx)("th",{children:"S\u1ed1 ca nhi\u1ec5m"})]})})})}),Object(p.jsx)("div",{className:"tbl-content",children:Object(p.jsx)("table",{cellPadding:"0",cellSpacing:"0",border:"0",children:Object(p.jsxs)("tbody",{children:[Object(p.jsx)("tr",{children:e.locations.map((function(e){return Object(p.jsx)("td",{onClick:function(){return t({activeMesh:e.normalizedName})},children:e.name},e.id)}))}),Object(p.jsx)("tr",{children:e.locations.map((function(e){return Object(p.jsx)("td",{children:C(e.cases)},e.id)}))})]})})})]})]})};var P=function(){var e=g.a.scale(["#f00","#0f0"]).colors(63),t=m((function(e){return e.data})),n=null===t||void 0===t?void 0:t.locations[0].cases,c=null===t||void 0===t?void 0:t.locations[31].cases;return Object(p.jsx)(p.Fragment,{children:t&&Object(p.jsxs)("div",{className:"color-scale",children:[Object(p.jsxs)("div",{className:"scale-bar",children:[Object(p.jsxs)("h4",{children:[C(n)," ca"]}),Object(p.jsxs)("h4",{children:[C(c)," ca"]}),Object(p.jsxs)("h4",{children:[0," ca"]})]}),Object(p.jsx)("div",{className:"color-bar",children:e.map((function(e){return Object(p.jsx)("span",{className:"color",style:{background:e}},e)}))})]})})},T=n.p+"static/media/rings.f85f7656.svg";var k=function(){return Object(p.jsxs)("div",{className:"fallback",children:[Object(p.jsx)("img",{className:"loader",alt:"loader",src:T}),Object(p.jsx)("h1",{children:"GETTING COVID DATA "})]})},F=function(){var e=m((function(e){return e.setData})),t=m((function(e){return e.setError})),n=m((function(e){return e.setLoading}));return Object(c.useEffect)((function(){fetch("https://static.pipezero.com/covid/data.json").then((function(e){if(e.ok)return e.json()})).then((function(t){var n=function(e){return e.map((function(e,t){return Object(o.a)(Object(o.a)({},e),{},{id:t,normalizedName:(n=e.name,"B\xe0 R\u1ecba \u2013 V\u0169ng T\xe0u"===n?"Vung_Tau":"TP. H\u1ed3 Ch\xed Minh"===n?"Ho_Chi_Minh":n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\u0111/g,"d").replace(/\u0110/g,"D").replace(/ /g,"_"))});var n}))}(t.locations);e(Object(o.a)(Object(o.a)({},t),{},{locations:n}))})).catch((function(e){return t(e)})).finally((function(){return n(!1)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(N,{}),Object(p.jsx)(P,{}),Object(p.jsxs)(s.a,{dpr:[1,1.5],shadows:!0,shadowMap:h.PCFSoftShadowMap,camera:{position:[18,19,36],fov:30},onCreated:function(e){e.gl.setClearColor("#659dbd")},children:[Object(p.jsx)("axesHelper",{}),Object(p.jsx)(l.a,{}),Object(p.jsx)(u.a,{attach:"orbitControls"}),Object(p.jsx)(w,{}),Object(p.jsx)(z,{}),Object(p.jsx)(c.Suspense,{fallback:Object(p.jsx)(d.a,{fullscreen:!0,children:Object(p.jsx)(k,{})}),children:Object(p.jsx)(S,{})})]})]})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(F,{})}),document.getElementById("root")),R()}},[[48,1,2]]]);
//# sourceMappingURL=main.9acd3561.chunk.js.map